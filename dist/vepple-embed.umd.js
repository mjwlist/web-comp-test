(function(a){typeof define=="function"&&define.amd?define(a):a()})(function(){"use strict";function a(){}function V(e){return e&&typeof e=="object"&&typeof e.then=="function"}function M(e){return e()}function O(){return Object.create(null)}function k(e){e.forEach(M)}function z(e){return typeof e=="function"}function B(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let C;function J(e,t){return C||(C=document.createElement("a")),C.href=t,e===C.href}function Q(e){return Object.keys(e).length===0}function w(e,t){e.appendChild(t)}function h(e,t,n){e.insertBefore(t,n||null)}function p(e){e.parentNode.removeChild(e)}function _(e){return document.createElement(e)}function v(e){return document.createTextNode(e)}function W(){return v(" ")}function K(){return v("")}function b(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function X(e){return Array.from(e.childNodes)}function S(e,t,n,r){n===null?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}function Y(e){const t={};for(const n of e)t[n.name]=n.value;return t}let x;function d(e){x=e}function Z(){if(!x)throw new Error("Function called outside component initialization");return x}const E=[],L=[],j=[],P=[],tt=Promise.resolve();let T=!1;function et(){T||(T=!0,tt.then($))}function N(e){j.push(e)}const U=new Set;let q=0;function $(){const e=x;do{for(;q<E.length;){const t=E[q];q++,d(t),nt(t.$$)}for(d(null),E.length=0,q=0;L.length;)L.pop()();for(let t=0;t<j.length;t+=1){const n=j[t];U.has(n)||(U.add(n),n())}j.length=0}while(E.length);for(;P.length;)P.pop()();T=!1,U.clear(),d(e)}function nt(e){if(e.fragment!==null){e.update(),k(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(N)}}const A=new Set;let g;function rt(){g={r:0,c:[],p:g}}function ot(){g.r||k(g.c),g=g.p}function R(e,t){e&&e.i&&(A.delete(e),e.i(t))}function ct(e,t,n,r){if(e&&e.o){if(A.has(e))return;A.add(e),g.c.push(()=>{A.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}}function H(e,t){const n=t.token={};function r(o,c,s,m){if(t.token!==n)return;t.resolved=m;let i=t.ctx;s!==void 0&&(i=i.slice(),i[s]=m);const l=o&&(t.current=o)(i);let u=!1;t.block&&(t.blocks?t.blocks.forEach((f,y)=>{y!==c&&f&&(rt(),ct(f,1,1,()=>{t.blocks[y]===f&&(t.blocks[y]=null)}),ot())}):t.block.d(1),l.c(),R(l,1),l.m(t.mount(),t.anchor),u=!0),t.block=l,t.blocks&&(t.blocks[c]=l),u&&$()}if(V(e)){const o=Z();if(e.then(c=>{d(o),r(t.then,1,t.value,c),d(null)},c=>{if(d(o),r(t.catch,2,t.error,c),d(null),!t.hasCatch)throw c}),t.current!==t.pending)return r(t.pending,0),!0}else{if(t.current!==t.then)return r(t.then,1,t.value,e),!0;t.resolved=e}}function I(e,t,n){const r=t.slice(),{resolved:o}=e;e.current===e.then&&(r[e.value]=o),e.current===e.catch&&(r[e.error]=o),e.block.p(r,n)}function lt(e,t,n,r){const{fragment:o,on_mount:c,on_destroy:s,after_update:m}=e.$$;o&&o.m(t,n),r||N(()=>{const i=c.map(M).filter(z);s?s.push(...i):k(i),e.$$.on_mount=[]}),m.forEach(N)}function st(e,t){const n=e.$$;n.fragment!==null&&(k(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function at(e,t){e.$$.dirty[0]===-1&&(E.push(e),et(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function it(e,t,n,r,o,c,s,m=[-1]){const i=x;d(e);const l=e.$$={fragment:null,ctx:null,props:c,update:a,not_equal:o,bound:O(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(i?i.$$.context:[])),callbacks:O(),dirty:m,skip_bound:!1,root:t.target||i.$$.root};s&&s(l.root);let u=!1;if(l.ctx=n?n(e,t.props||{},(f,y,...F)=>{const G=F.length?F[0]:y;return l.ctx&&o(l.ctx[f],l.ctx[f]=G)&&(!l.skip_bound&&l.bound[f]&&l.bound[f](G),u&&at(e,f)),y}):[],l.update(),u=!0,k(l.before_update),l.fragment=r?r(l.ctx):!1,t.target){if(t.hydrate){const f=X(t.target);l.fragment&&l.fragment.l(f),f.forEach(p)}else l.fragment&&l.fragment.c();t.intro&&R(e.$$.fragment),lt(e,t.target,t.anchor,t.customElement),$()}d(i)}let D;typeof HTMLElement=="function"&&(D=class extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(M).filter(z);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(e,t,n){this[e]=n}disconnectedCallback(){k(this.$$.on_disconnect)}$destroy(){st(this,1),this.$destroy=a}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const r=n.indexOf(t);r!==-1&&n.splice(r,1)}}$set(e){this.$$set&&!Q(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});function ut(e){let t,n=e[6].message+"",r;return{c(){t=_("p"),r=v(n),S(t,"color","red")},m(o,c){h(o,t,c),w(t,r)},p:a,d(o){o&&p(t)}}}function ft(e){let t,n,r;return{c(){t=_("div"),n=_("iframe"),n.allowFullscreen=!0,S(n,"border-style","none"),b(n,"part","iframe"),J(n.src,r=`https://mjwlist.github.io/web-comp-test/dist/pannellum.htm#panorama=${e[0].panorama.mediaItemUrl}&preview=${e[0].panorama.sourceUrl}`)||b(n,"src",r),b(t,"class","wrap"),b(t,"part","wrap")},m(o,c){h(o,t,c),w(t,n)},p:a,d(o){o&&p(t)}}}function dt(e){let t;return{c(){t=_("p"),t.textContent="...waiting"},m(n,r){h(n,t,r)},p:a,d(n){n&&p(t)}}}function ht(e){let t,n=e[6].message+"",r;return{c(){t=_("p"),r=v(n),S(t,"color","red")},m(o,c){h(o,t,c),w(t,r)},p:a,d(o){o&&p(t)}}}function pt(e){let t,n,r=e[1].ctaText+"",o;return{c(){t=_("div"),n=_("a"),o=v(r),b(n,"part","link"),b(n,"href",e[1].ctaUrl),b(t,"part","content")},m(c,s){h(c,t,s),w(t,n),w(n,o)},p:a,d(c){c&&p(t)}}}function mt(e){return{c:a,m:a,p:a,d:a}}function _t(e){let t,n,r={ctx:e,current:null,token:null,hasCatch:!0,pending:dt,then:ft,catch:ut,value:0,error:6};H(e[0],r);let o={ctx:e,current:null,token:null,hasCatch:!0,pending:mt,then:pt,catch:ht,value:1,error:6};return H(e[1],o),{c(){r.block.c(),t=W(),n=K(),o.block.c(),this.c=a},m(c,s){r.block.m(c,r.anchor=s),r.mount=()=>t.parentNode,r.anchor=t,h(c,t,s),h(c,n,s),o.block.m(c,o.anchor=s),o.mount=()=>n.parentNode,o.anchor=n},p(c,[s]){e=c,I(r,e,s),I(o,e,s)},i:a,o:a,d(c){r.block.d(c),r.token=null,r=null,c&&p(t),c&&p(n),o.block.d(c),o.token=null,o=null}}}function bt(e,t,n){let{post:r}=t,{api:o}=t;async function c(){const l=await fetch(`${o}/wp-json/rv/v1/settings`),u=await l.json();if(l.ok)return u.ctas[0];throw new Error(u)}async function s(){const l=await fetch(`${o}/graphql`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
            query MyQuery($name: String!) {
              posts(where: {name: $name}) {
                  nodes {
                    slug
                    postContent {
                      panorama {
                        title(format: RAW)
                        mediaItemUrl
                        sourceUrl(size: MEDIUM_LARGE)
                      }
                      position {
                        horizontal
                        vertical
                      }
                    }
                  }
                }
            }
      `,variables:{name:r}})}),u=await l.json();if(console.log(u),l.ok)return u.data.posts.nodes[0].postContent;throw new Error(u)}const m=s(),i=c();return e.$$set=l=>{"post"in l&&n(2,r=l.post),"api"in l&&n(3,o=l.api)},[m,i,r,o]}class gt extends D{constructor(t){super();this.shadowRoot.innerHTML="<style>*,*:before,*:after{box-sizing:border-box}.wrap{position:relative;padding-bottom:56.25%;height:0;overflow:hidden}iframe{position:absolute;top:0;left:0;width:100%;height:100%}</style>",it(this,{target:this.shadowRoot,props:Y(this.attributes),customElement:!0},bt,_t,B,{post:2,api:3},null),t&&(t.target&&h(t.target,this,t.anchor),t.props&&(this.$set(t.props),$()))}static get observedAttributes(){return["post","api"]}get post(){return this.$$.ctx[2]}set post(t){this.$$set({post:t}),$()}get api(){return this.$$.ctx[3]}set api(t){this.$$set({api:t}),$()}}customElements.define("vepple-embed",gt)});
